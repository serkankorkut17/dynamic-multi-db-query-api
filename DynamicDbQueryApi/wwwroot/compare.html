<!doctype html>
<html lang="tr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Dynamic Query Console</title>
    <style>
      :root { color-scheme: light dark; font-family: system-ui, Arial, sans-serif; }
      body { margin: 1.25rem; line-height: 1.4; }
      h1 { margin-top: 0; }
      fieldset { border: 1px solid #777; padding: .75rem 1rem 1rem; margin-bottom: 1.25rem; }
      legend { font-weight: 600; padding: 0 .5rem; }
      label { display:block; font-size:.8rem; font-weight:600; text-transform:uppercase; letter-spacing:.05em; margin-top:.75rem; }
      input[type=text], textarea, select { width:100%; box-sizing:border-box; font:inherit; padding:.5rem; border:1px solid #666; border-radius:4px; background:var(--bg,inherit); }
      textarea { min-height:90px; resize:vertical; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
      .row { display:flex; flex-wrap:wrap; gap:1.25rem; }
      .col { flex:1 1 420px; min-width:320px; }
      button { cursor:pointer; padding:.55rem .95rem; font:inherit; border:1px solid #555; border-radius:4px; background:#1e6bd6; color:#fff; font-weight:600; display:inline-flex; align-items:center; gap:.4rem; }
      button.secondary { background:#555; }
      button:disabled { opacity:.55; cursor:progress; }
      pre { background:#1115; padding:.75rem 1rem; border-radius:6px; overflow:auto; max-height:340px; font-size:.78rem; }
      .outputs { display:flex; flex-wrap:wrap; gap:1.25rem; }
      .panel { flex:1 1 460px; min-width:320px; }
      .bad { color:#d33; font-weight:600; }
      .toolbar { display:flex; gap:.5rem; margin-top:.6rem; }
      small.hint { opacity:.75; font-weight:400; font-size:.65rem; display:block; margin-top:.2rem; }
      .badge { background:#444; color:#fff; padding:.15rem .45rem; border-radius:999px; font-size:.65rem; font-weight:600; letter-spacing:.05em; }
      .flex-end { display:flex; justify-content:flex-end; gap:.5rem; }
      hr { margin:2rem 0; border:none; border-top:1px solid #444; }
    </style>
  </head>
  <body>
    <h1>Dynamic Query Console</h1>
    <p>Ortak veritabanı bilgileriyle hem özel DSL sorgunu hem de ham SQL sorgunu çalıştır.</p>

    <form id="shared" onsubmit="return false;">
      <fieldset>
        <legend>Bağlantı Bilgileri</legend>
        <div class="row">
          <div class="col">
            <label for="dbType">DB Type</label>
            <select id="dbType">
              <option value="postgres">PostgreSQL</option>
              <option value="mysql">MySQL</option>
              <option value="mssql">SQL Server</option>
              <option value="oracle">Oracle</option>
            </select>
          </div>
        </div>
        <label for="conn">Connection String</label>
        <textarea id="conn" placeholder="Host=localhost;Port=5432;Database=querydb;Username=postgres;Password=postgres"></textarea>
      </fieldset>
    </form>

    <div class="row">
      <div class="col">
        <fieldset>
          <legend>DSL Query <span class="badge">/api/query</span></legend>
          <label for="dsl">Custom Sorgu</label>
          <textarea id="dsl" placeholder="FETCH(id, name) FILTER(age > 18 AND status = 'A') INCLUDE(orders) FROM users"></textarea>
          <div class="toolbar flex-end">
            <button type="button" id="runDsl">Çalıştır</button>
            <button type="button" class="secondary" id="clearDsl">Temizle</button>
          </div>
        </fieldset>
      </div>
      <div class="col">
        <fieldset>
          <legend>Raw SQL <span class="badge">/api/query/sql</span></legend>
          <label for="sql">SQL Sorgusu</label>
            <textarea id="sql" placeholder="SELECT id, name FROM users WHERE age > 18 ORDER BY id DESC LIMIT 20;"></textarea>
          <div class="toolbar flex-end">
            <button type="button" id="runSql">Çalıştır</button>
            <button type="button" class="secondary" id="clearSql">Temizle</button>
          </div>
        </fieldset>
      </div>
    </div>

    <hr />
    <div class="outputs">
      <div class="panel">
        <h3>DSL Sonuç</h3>
        <pre id="outDsl">(henüz yok)</pre>
      </div>
      <div class="panel">
        <h3>SQL Sonuç</h3>
        <pre id="outSql">(henüz yok)</pre>
      </div>
    </div>

    <hr />
    <fieldset>
      <legend>Karşılaştırma</legend>
      <div class="toolbar">
        <button type="button" id="compareBtn">Sonuçları Karşılaştır</button>
        <button type="button" class="secondary" id="clearCompare">Temizle</button>
      </div>
      <small class="hint">Karşılaştırma; primitive değerleri, dizileri ve nesneleri yapısal olarak kıyaslar. Nesne/dizi sırasını yok saymak için kanonikleştirilmiş karşılaştırma yapılır.</small>
      <pre id="outCompare">(henüz yok)</pre>
    </fieldset>
    <script src="compare.js"></script>
  </body>
</html>
